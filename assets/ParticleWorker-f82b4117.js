(function(){"use strict";/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const J="151";function F(m,t,s){return Math.max(t,Math.min(s,m))}class f{constructor(t=0,s=0,i=0,h=1){this.isQuaternion=!0,this._x=t,this._y=s,this._z=i,this._w=h}static slerpFlat(t,s,i,h,n,o,e){let _=i[h+0],r=i[h+1],a=i[h+2],c=i[h+3];const u=n[o+0],l=n[o+1],y=n[o+2],x=n[o+3];if(e===0){t[s+0]=_,t[s+1]=r,t[s+2]=a,t[s+3]=c;return}if(e===1){t[s+0]=u,t[s+1]=l,t[s+2]=y,t[s+3]=x;return}if(c!==x||_!==u||r!==l||a!==y){let M=1-e;const z=_*u+r*l+a*y+c*x,C=z>=0?1:-1,k=1-z*z;if(k>Number.EPSILON){const w=Math.sqrt(k),p=Math.atan2(w,z*C);M=Math.sin(M*p)/w,e=Math.sin(e*p)/w}const g=e*C;if(_=_*M+u*g,r=r*M+l*g,a=a*M+y*g,c=c*M+x*g,M===1-e){const w=1/Math.sqrt(_*_+r*r+a*a+c*c);_*=w,r*=w,a*=w,c*=w}}t[s]=_,t[s+1]=r,t[s+2]=a,t[s+3]=c}static multiplyQuaternionsFlat(t,s,i,h,n,o){const e=i[h],_=i[h+1],r=i[h+2],a=i[h+3],c=n[o],u=n[o+1],l=n[o+2],y=n[o+3];return t[s]=e*y+a*c+_*l-r*u,t[s+1]=_*y+a*u+r*c-e*l,t[s+2]=r*y+a*l+e*u-_*c,t[s+3]=a*y-e*c-_*u-r*l,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,s,i,h){return this._x=t,this._y=s,this._z=i,this._w=h,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,s){const i=t._x,h=t._y,n=t._z,o=t._order,e=Math.cos,_=Math.sin,r=e(i/2),a=e(h/2),c=e(n/2),u=_(i/2),l=_(h/2),y=_(n/2);switch(o){case"XYZ":this._x=u*a*c+r*l*y,this._y=r*l*c-u*a*y,this._z=r*a*y+u*l*c,this._w=r*a*c-u*l*y;break;case"YXZ":this._x=u*a*c+r*l*y,this._y=r*l*c-u*a*y,this._z=r*a*y-u*l*c,this._w=r*a*c+u*l*y;break;case"ZXY":this._x=u*a*c-r*l*y,this._y=r*l*c+u*a*y,this._z=r*a*y+u*l*c,this._w=r*a*c-u*l*y;break;case"ZYX":this._x=u*a*c-r*l*y,this._y=r*l*c+u*a*y,this._z=r*a*y-u*l*c,this._w=r*a*c+u*l*y;break;case"YZX":this._x=u*a*c+r*l*y,this._y=r*l*c+u*a*y,this._z=r*a*y-u*l*c,this._w=r*a*c-u*l*y;break;case"XZY":this._x=u*a*c-r*l*y,this._y=r*l*c-u*a*y,this._z=r*a*y+u*l*c,this._w=r*a*c+u*l*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return s!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,s){const i=s/2,h=Math.sin(i);return this._x=t.x*h,this._y=t.y*h,this._z=t.z*h,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const s=t.elements,i=s[0],h=s[4],n=s[8],o=s[1],e=s[5],_=s[9],r=s[2],a=s[6],c=s[10],u=i+e+c;if(u>0){const l=.5/Math.sqrt(u+1);this._w=.25/l,this._x=(a-_)*l,this._y=(n-r)*l,this._z=(o-h)*l}else if(i>e&&i>c){const l=2*Math.sqrt(1+i-e-c);this._w=(a-_)/l,this._x=.25*l,this._y=(h+o)/l,this._z=(n+r)/l}else if(e>c){const l=2*Math.sqrt(1+e-i-c);this._w=(n-r)/l,this._x=(h+o)/l,this._y=.25*l,this._z=(_+a)/l}else{const l=2*Math.sqrt(1+c-i-e);this._w=(o-h)/l,this._x=(n+r)/l,this._y=(_+a)/l,this._z=.25*l}return this._onChangeCallback(),this}setFromUnitVectors(t,s){let i=t.dot(s)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*s.z-t.z*s.y,this._y=t.z*s.x-t.x*s.z,this._z=t.x*s.y-t.y*s.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(F(this.dot(t),-1,1)))}rotateTowards(t,s){const i=this.angleTo(t);if(i===0)return this;const h=Math.min(1,s/i);return this.slerp(t,h),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,s){const i=t._x,h=t._y,n=t._z,o=t._w,e=s._x,_=s._y,r=s._z,a=s._w;return this._x=i*a+o*e+h*r-n*_,this._y=h*a+o*_+n*e-i*r,this._z=n*a+o*r+i*_-h*e,this._w=o*a-i*e-h*_-n*r,this._onChangeCallback(),this}slerp(t,s){if(s===0)return this;if(s===1)return this.copy(t);const i=this._x,h=this._y,n=this._z,o=this._w;let e=o*t._w+i*t._x+h*t._y+n*t._z;if(e<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,e=-e):this.copy(t),e>=1)return this._w=o,this._x=i,this._y=h,this._z=n,this;const _=1-e*e;if(_<=Number.EPSILON){const l=1-s;return this._w=l*o+s*this._w,this._x=l*i+s*this._x,this._y=l*h+s*this._y,this._z=l*n+s*this._z,this.normalize(),this._onChangeCallback(),this}const r=Math.sqrt(_),a=Math.atan2(r,e),c=Math.sin((1-s)*a)/r,u=Math.sin(s*a)/r;return this._w=o*c+this._w*u,this._x=i*c+this._x*u,this._y=h*c+this._y*u,this._z=n*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,s,i){return this.copy(t).slerp(s,i)}random(){const t=Math.random(),s=Math.sqrt(1-t),i=Math.sqrt(t),h=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(s*Math.cos(h),i*Math.sin(n),i*Math.cos(n),s*Math.sin(h))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,s=0){return this._x=t[s],this._y=t[s+1],this._z=t[s+2],this._w=t[s+3],this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._w,t}fromBufferAttribute(t,s){return this._x=t.getX(s),this._y=t.getY(s),this._z=t.getZ(s),this._w=t.getW(s),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class S{constructor(t=0,s=0,i=0){S.prototype.isVector3=!0,this.x=t,this.y=s,this.z=i}set(t,s,i){return i===void 0&&(i=this.z),this.x=t,this.y=s,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this}applyEuler(t){return this.applyQuaternion(K.setFromEuler(t))}applyAxisAngle(t,s){return this.applyQuaternion(K.setFromAxisAngle(t,s))}applyMatrix3(t){const s=this.x,i=this.y,h=this.z,n=t.elements;return this.x=n[0]*s+n[3]*i+n[6]*h,this.y=n[1]*s+n[4]*i+n[7]*h,this.z=n[2]*s+n[5]*i+n[8]*h,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const s=this.x,i=this.y,h=this.z,n=t.elements,o=1/(n[3]*s+n[7]*i+n[11]*h+n[15]);return this.x=(n[0]*s+n[4]*i+n[8]*h+n[12])*o,this.y=(n[1]*s+n[5]*i+n[9]*h+n[13])*o,this.z=(n[2]*s+n[6]*i+n[10]*h+n[14])*o,this}applyQuaternion(t){const s=this.x,i=this.y,h=this.z,n=t.x,o=t.y,e=t.z,_=t.w,r=_*s+o*h-e*i,a=_*i+e*s-n*h,c=_*h+n*i-o*s,u=-n*s-o*i-e*h;return this.x=r*_+u*-n+a*-e-c*-o,this.y=a*_+u*-o+c*-n-r*-e,this.z=c*_+u*-e+r*-o-a*-n,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const s=this.x,i=this.y,h=this.z,n=t.elements;return this.x=n[0]*s+n[4]*i+n[8]*h,this.y=n[1]*s+n[5]*i+n[9]*h,this.z=n[2]*s+n[6]*i+n[10]*h,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,s){return this.x=Math.max(t.x,Math.min(s.x,this.x)),this.y=Math.max(t.y,Math.min(s.y,this.y)),this.z=Math.max(t.z,Math.min(s.z,this.z)),this}clampScalar(t,s){return this.x=Math.max(t,Math.min(s,this.x)),this.y=Math.max(t,Math.min(s,this.y)),this.z=Math.max(t,Math.min(s,this.z)),this}clampLength(t,s){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(s,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this.z+=(t.z-this.z)*s,this}lerpVectors(t,s,i){return this.x=t.x+(s.x-t.x)*i,this.y=t.y+(s.y-t.y)*i,this.z=t.z+(s.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,s){const i=t.x,h=t.y,n=t.z,o=s.x,e=s.y,_=s.z;return this.x=h*_-n*e,this.y=n*o-i*_,this.z=i*e-h*o,this}projectOnVector(t){const s=t.lengthSq();if(s===0)return this.set(0,0,0);const i=t.dot(this)/s;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return G.copy(this).projectOnVector(t),this.sub(G)}reflect(t){return this.sub(G.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const s=Math.sqrt(this.lengthSq()*t.lengthSq());if(s===0)return Math.PI/2;const i=this.dot(t)/s;return Math.acos(F(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const s=this.x-t.x,i=this.y-t.y,h=this.z-t.z;return s*s+i*i+h*h}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,s,i){const h=Math.sin(s)*t;return this.x=h*Math.sin(i),this.y=Math.cos(s)*t,this.z=h*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,s,i){return this.x=t*Math.sin(s),this.y=i,this.z=t*Math.cos(s),this}setFromMatrixPosition(t){const s=t.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(t){const s=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),h=this.setFromMatrixColumn(t,2).length();return this.x=s,this.y=i,this.z=h,this}setFromMatrixColumn(t,s){return this.fromArray(t.elements,s*4)}setFromMatrix3Column(t,s){return this.fromArray(t.elements,s*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,s=0){return this.x=t[s],this.y=t[s+1],this.z=t[s+2],this}toArray(t=[],s=0){return t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t}fromBufferAttribute(t,s){return this.x=t.getX(s),this.y=t.getY(s),this.z=t.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,s=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(s),this.y=i*Math.sin(s),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const G=new S,K=new f;class P{constructor(){P.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,s,i,h,n,o,e,_,r,a,c,u,l,y,x,M){const z=this.elements;return z[0]=t,z[4]=s,z[8]=i,z[12]=h,z[1]=n,z[5]=o,z[9]=e,z[13]=_,z[2]=r,z[6]=a,z[10]=c,z[14]=u,z[3]=l,z[7]=y,z[11]=x,z[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new P().fromArray(this.elements)}copy(t){const s=this.elements,i=t.elements;return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s[6]=i[6],s[7]=i[7],s[8]=i[8],s[9]=i[9],s[10]=i[10],s[11]=i[11],s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15],this}copyPosition(t){const s=this.elements,i=t.elements;return s[12]=i[12],s[13]=i[13],s[14]=i[14],this}setFromMatrix3(t){const s=t.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(t,s,i){return t.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,s,i){return this.set(t.x,s.x,i.x,0,t.y,s.y,i.y,0,t.z,s.z,i.z,0,0,0,0,1),this}extractRotation(t){const s=this.elements,i=t.elements,h=1/R.setFromMatrixColumn(t,0).length(),n=1/R.setFromMatrixColumn(t,1).length(),o=1/R.setFromMatrixColumn(t,2).length();return s[0]=i[0]*h,s[1]=i[1]*h,s[2]=i[2]*h,s[3]=0,s[4]=i[4]*n,s[5]=i[5]*n,s[6]=i[6]*n,s[7]=0,s[8]=i[8]*o,s[9]=i[9]*o,s[10]=i[10]*o,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(t){const s=this.elements,i=t.x,h=t.y,n=t.z,o=Math.cos(i),e=Math.sin(i),_=Math.cos(h),r=Math.sin(h),a=Math.cos(n),c=Math.sin(n);if(t.order==="XYZ"){const u=o*a,l=o*c,y=e*a,x=e*c;s[0]=_*a,s[4]=-_*c,s[8]=r,s[1]=l+y*r,s[5]=u-x*r,s[9]=-e*_,s[2]=x-u*r,s[6]=y+l*r,s[10]=o*_}else if(t.order==="YXZ"){const u=_*a,l=_*c,y=r*a,x=r*c;s[0]=u+x*e,s[4]=y*e-l,s[8]=o*r,s[1]=o*c,s[5]=o*a,s[9]=-e,s[2]=l*e-y,s[6]=x+u*e,s[10]=o*_}else if(t.order==="ZXY"){const u=_*a,l=_*c,y=r*a,x=r*c;s[0]=u-x*e,s[4]=-o*c,s[8]=y+l*e,s[1]=l+y*e,s[5]=o*a,s[9]=x-u*e,s[2]=-o*r,s[6]=e,s[10]=o*_}else if(t.order==="ZYX"){const u=o*a,l=o*c,y=e*a,x=e*c;s[0]=_*a,s[4]=y*r-l,s[8]=u*r+x,s[1]=_*c,s[5]=x*r+u,s[9]=l*r-y,s[2]=-r,s[6]=e*_,s[10]=o*_}else if(t.order==="YZX"){const u=o*_,l=o*r,y=e*_,x=e*r;s[0]=_*a,s[4]=x-u*c,s[8]=y*c+l,s[1]=c,s[5]=o*a,s[9]=-e*a,s[2]=-r*a,s[6]=l*c+y,s[10]=u-x*c}else if(t.order==="XZY"){const u=o*_,l=o*r,y=e*_,x=e*r;s[0]=_*a,s[4]=-c,s[8]=r*a,s[1]=u*c+x,s[5]=o*a,s[9]=l*c-y,s[2]=y*c-l,s[6]=e*a,s[10]=x*c+u}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(t){return this.compose(it,t,ht)}lookAt(t,s,i){const h=this.elements;return b.subVectors(t,s),b.lengthSq()===0&&(b.z=1),b.normalize(),q.crossVectors(i,b),q.lengthSq()===0&&(Math.abs(i.z)===1?b.x+=1e-4:b.z+=1e-4,b.normalize(),q.crossVectors(i,b)),q.normalize(),X.crossVectors(b,q),h[0]=q.x,h[4]=X.x,h[8]=b.x,h[1]=q.y,h[5]=X.y,h[9]=b.y,h[2]=q.z,h[6]=X.z,h[10]=b.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,s){const i=t.elements,h=s.elements,n=this.elements,o=i[0],e=i[4],_=i[8],r=i[12],a=i[1],c=i[5],u=i[9],l=i[13],y=i[2],x=i[6],M=i[10],z=i[14],C=i[3],k=i[7],g=i[11],w=i[15],p=h[0],d=h[4],T=h[8],A=h[12],I=h[1],V=h[5],Q=h[9],N=h[13],j=h[2],D=h[6],L=h[10],H=h[14],B=h[3],$=h[7],U=h[11],W=h[15];return n[0]=o*p+e*I+_*j+r*B,n[4]=o*d+e*V+_*D+r*$,n[8]=o*T+e*Q+_*L+r*U,n[12]=o*A+e*N+_*H+r*W,n[1]=a*p+c*I+u*j+l*B,n[5]=a*d+c*V+u*D+l*$,n[9]=a*T+c*Q+u*L+l*U,n[13]=a*A+c*N+u*H+l*W,n[2]=y*p+x*I+M*j+z*B,n[6]=y*d+x*V+M*D+z*$,n[10]=y*T+x*Q+M*L+z*U,n[14]=y*A+x*N+M*H+z*W,n[3]=C*p+k*I+g*j+w*B,n[7]=C*d+k*V+g*D+w*$,n[11]=C*T+k*Q+g*L+w*U,n[15]=C*A+k*N+g*H+w*W,this}multiplyScalar(t){const s=this.elements;return s[0]*=t,s[4]*=t,s[8]*=t,s[12]*=t,s[1]*=t,s[5]*=t,s[9]*=t,s[13]*=t,s[2]*=t,s[6]*=t,s[10]*=t,s[14]*=t,s[3]*=t,s[7]*=t,s[11]*=t,s[15]*=t,this}determinant(){const t=this.elements,s=t[0],i=t[4],h=t[8],n=t[12],o=t[1],e=t[5],_=t[9],r=t[13],a=t[2],c=t[6],u=t[10],l=t[14],y=t[3],x=t[7],M=t[11],z=t[15];return y*(+n*_*c-h*r*c-n*e*u+i*r*u+h*e*l-i*_*l)+x*(+s*_*l-s*r*u+n*o*u-h*o*l+h*r*a-n*_*a)+M*(+s*r*c-s*e*l-n*o*c+i*o*l+n*e*a-i*r*a)+z*(-h*e*a-s*_*c+s*e*u+h*o*c-i*o*u+i*_*a)}transpose(){const t=this.elements;let s;return s=t[1],t[1]=t[4],t[4]=s,s=t[2],t[2]=t[8],t[8]=s,s=t[6],t[6]=t[9],t[9]=s,s=t[3],t[3]=t[12],t[12]=s,s=t[7],t[7]=t[13],t[13]=s,s=t[11],t[11]=t[14],t[14]=s,this}setPosition(t,s,i){const h=this.elements;return t.isVector3?(h[12]=t.x,h[13]=t.y,h[14]=t.z):(h[12]=t,h[13]=s,h[14]=i),this}invert(){const t=this.elements,s=t[0],i=t[1],h=t[2],n=t[3],o=t[4],e=t[5],_=t[6],r=t[7],a=t[8],c=t[9],u=t[10],l=t[11],y=t[12],x=t[13],M=t[14],z=t[15],C=c*M*r-x*u*r+x*_*l-e*M*l-c*_*z+e*u*z,k=y*u*r-a*M*r-y*_*l+o*M*l+a*_*z-o*u*z,g=a*x*r-y*c*r+y*e*l-o*x*l-a*e*z+o*c*z,w=y*c*_-a*x*_-y*e*u+o*x*u+a*e*M-o*c*M,p=s*C+i*k+h*g+n*w;if(p===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const d=1/p;return t[0]=C*d,t[1]=(x*u*n-c*M*n-x*h*l+i*M*l+c*h*z-i*u*z)*d,t[2]=(e*M*n-x*_*n+x*h*r-i*M*r-e*h*z+i*_*z)*d,t[3]=(c*_*n-e*u*n-c*h*r+i*u*r+e*h*l-i*_*l)*d,t[4]=k*d,t[5]=(a*M*n-y*u*n+y*h*l-s*M*l-a*h*z+s*u*z)*d,t[6]=(y*_*n-o*M*n-y*h*r+s*M*r+o*h*z-s*_*z)*d,t[7]=(o*u*n-a*_*n+a*h*r-s*u*r-o*h*l+s*_*l)*d,t[8]=g*d,t[9]=(y*c*n-a*x*n-y*i*l+s*x*l+a*i*z-s*c*z)*d,t[10]=(o*x*n-y*e*n+y*i*r-s*x*r-o*i*z+s*e*z)*d,t[11]=(a*e*n-o*c*n-a*i*r+s*c*r+o*i*l-s*e*l)*d,t[12]=w*d,t[13]=(a*x*h-y*c*h+y*i*u-s*x*u-a*i*M+s*c*M)*d,t[14]=(y*e*h-o*x*h-y*i*_+s*x*_+o*i*M-s*e*M)*d,t[15]=(o*c*h-a*e*h+a*i*_-s*c*_-o*i*u+s*e*u)*d,this}scale(t){const s=this.elements,i=t.x,h=t.y,n=t.z;return s[0]*=i,s[4]*=h,s[8]*=n,s[1]*=i,s[5]*=h,s[9]*=n,s[2]*=i,s[6]*=h,s[10]*=n,s[3]*=i,s[7]*=h,s[11]*=n,this}getMaxScaleOnAxis(){const t=this.elements,s=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],h=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(s,i,h))}makeTranslation(t,s,i){return this.set(1,0,0,t,0,1,0,s,0,0,1,i,0,0,0,1),this}makeRotationX(t){const s=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,s,-i,0,0,i,s,0,0,0,0,1),this}makeRotationY(t){const s=Math.cos(t),i=Math.sin(t);return this.set(s,0,i,0,0,1,0,0,-i,0,s,0,0,0,0,1),this}makeRotationZ(t){const s=Math.cos(t),i=Math.sin(t);return this.set(s,-i,0,0,i,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,s){const i=Math.cos(s),h=Math.sin(s),n=1-i,o=t.x,e=t.y,_=t.z,r=n*o,a=n*e;return this.set(r*o+i,r*e-h*_,r*_+h*e,0,r*e+h*_,a*e+i,a*_-h*o,0,r*_-h*e,a*_+h*o,n*_*_+i,0,0,0,0,1),this}makeScale(t,s,i){return this.set(t,0,0,0,0,s,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,s,i,h,n,o){return this.set(1,i,n,0,t,1,o,0,s,h,1,0,0,0,0,1),this}compose(t,s,i){const h=this.elements,n=s._x,o=s._y,e=s._z,_=s._w,r=n+n,a=o+o,c=e+e,u=n*r,l=n*a,y=n*c,x=o*a,M=o*c,z=e*c,C=_*r,k=_*a,g=_*c,w=i.x,p=i.y,d=i.z;return h[0]=(1-(x+z))*w,h[1]=(l+g)*w,h[2]=(y-k)*w,h[3]=0,h[4]=(l-g)*p,h[5]=(1-(u+z))*p,h[6]=(M+C)*p,h[7]=0,h[8]=(y+k)*d,h[9]=(M-C)*d,h[10]=(1-(u+x))*d,h[11]=0,h[12]=t.x,h[13]=t.y,h[14]=t.z,h[15]=1,this}decompose(t,s,i){const h=this.elements;let n=R.set(h[0],h[1],h[2]).length();const o=R.set(h[4],h[5],h[6]).length(),e=R.set(h[8],h[9],h[10]).length();this.determinant()<0&&(n=-n),t.x=h[12],t.y=h[13],t.z=h[14],E.copy(this);const r=1/n,a=1/o,c=1/e;return E.elements[0]*=r,E.elements[1]*=r,E.elements[2]*=r,E.elements[4]*=a,E.elements[5]*=a,E.elements[6]*=a,E.elements[8]*=c,E.elements[9]*=c,E.elements[10]*=c,s.setFromRotationMatrix(E),i.x=n,i.y=o,i.z=e,this}makePerspective(t,s,i,h,n,o){const e=this.elements,_=2*n/(s-t),r=2*n/(i-h),a=(s+t)/(s-t),c=(i+h)/(i-h),u=-(o+n)/(o-n),l=-2*o*n/(o-n);return e[0]=_,e[4]=0,e[8]=a,e[12]=0,e[1]=0,e[5]=r,e[9]=c,e[13]=0,e[2]=0,e[6]=0,e[10]=u,e[14]=l,e[3]=0,e[7]=0,e[11]=-1,e[15]=0,this}makeOrthographic(t,s,i,h,n,o){const e=this.elements,_=1/(s-t),r=1/(i-h),a=1/(o-n),c=(s+t)*_,u=(i+h)*r,l=(o+n)*a;return e[0]=2*_,e[4]=0,e[8]=0,e[12]=-c,e[1]=0,e[5]=2*r,e[9]=0,e[13]=-u,e[2]=0,e[6]=0,e[10]=-2*a,e[14]=-l,e[3]=0,e[7]=0,e[11]=0,e[15]=1,this}equals(t){const s=this.elements,i=t.elements;for(let h=0;h<16;h++)if(s[h]!==i[h])return!1;return!0}fromArray(t,s=0){for(let i=0;i<16;i++)this.elements[i]=t[i+s];return this}toArray(t=[],s=0){const i=this.elements;return t[s]=i[0],t[s+1]=i[1],t[s+2]=i[2],t[s+3]=i[3],t[s+4]=i[4],t[s+5]=i[5],t[s+6]=i[6],t[s+7]=i[7],t[s+8]=i[8],t[s+9]=i[9],t[s+10]=i[10],t[s+11]=i[11],t[s+12]=i[12],t[s+13]=i[13],t[s+14]=i[14],t[s+15]=i[15],t}}const R=new S,E=new P,it=new S(0,0,0),ht=new S(1,1,1),q=new S,X=new S,b=new S,O=new P,v=new f;class Y{constructor(t=0,s=0,i=0,h=Y.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=s,this._z=i,this._order=h}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,s,i,h=this._order){return this._x=t,this._y=s,this._z=i,this._order=h,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,s=this._order,i=!0){const h=t.elements,n=h[0],o=h[4],e=h[8],_=h[1],r=h[5],a=h[9],c=h[2],u=h[6],l=h[10];switch(s){case"XYZ":this._y=Math.asin(F(e,-1,1)),Math.abs(e)<.9999999?(this._x=Math.atan2(-a,l),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(u,r),this._z=0);break;case"YXZ":this._x=Math.asin(-F(a,-1,1)),Math.abs(a)<.9999999?(this._y=Math.atan2(e,l),this._z=Math.atan2(_,r)):(this._y=Math.atan2(-c,n),this._z=0);break;case"ZXY":this._x=Math.asin(F(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-c,l),this._z=Math.atan2(-o,r)):(this._y=0,this._z=Math.atan2(_,n));break;case"ZYX":this._y=Math.asin(-F(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,l),this._z=Math.atan2(_,n)):(this._x=0,this._z=Math.atan2(-o,r));break;case"YZX":this._z=Math.asin(F(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-a,r),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(e,l));break;case"XZY":this._z=Math.asin(-F(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(u,r),this._y=Math.atan2(e,n)):(this._x=Math.atan2(-a,l),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,s,i){return O.makeRotationFromQuaternion(t),this.setFromRotationMatrix(O,s,i)}setFromVector3(t,s=this._order){return this.set(t.x,t.y,t.z,s)}reorder(t){return v.setFromEuler(this),this.setFromQuaternion(v,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Y.DEFAULT_ORDER="XYZ",typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:J}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=J);function Z(m,t){return m+Math.random()*(t-m)}const tt=(m,t,s)=>{const i=t.map((n,o)=>n-m[o]);return Math.sqrt(i[0]**2+i[1]**2+i[2]**2)<s},st=(m,t=1)=>{const s=[0,0,0];let i=[0,0,0];for(;tt(i,s,m);)i=nt(t);return i},nt=(m=1)=>{const t=Math.random(),s=Math.random(),i=t*2*Math.PI,h=Math.acos(2*s-1),n=Math.cbrt(Math.random()),o=Math.sin(i),e=Math.cos(i),_=Math.sin(h),r=Math.cos(h),a=n*_*e,c=n*_*o,u=n*r;return[a*m,c*m,u*m]};function et(m,t=1){for(let s=0;s<m.length;s+=3){m[s+1]+=Z(-t,t),m[s]+=Z(-t*27.5,t*32.5),m[s+2]+=Z(-t*32.5,t*27.5);const i=[m[s],m[s+1],m[s+2]];for(let h=0;h<m.length;h+=3){if(s==h)continue;const n=[m[h],m[h+1],m[h+2]];tt(n,i,t)&&(m[h+1]+=Z(-t,t))}}return m}(function(){const m=new S,t=new Y,s=new f,i=new S;return function(h,n){const[o,e,_]=st(n.distanceStart,n.distanceEnd);m.x=o,m.y=e,m.z=_,t.x=Math.random()*2*Math.PI,t.y=Math.random()*2*Math.PI,t.z=Math.random()*2*Math.PI,s.setFromEuler(t),i.x=i.y=i.z=Z(2,1e3),h.compose(m,s,i)}})();const rt=1e5,ot=67319e8;function at(m){const t=m.distanceToParent+ot,s=(t-m.distanceToParent)/m.distScale,i=t/m.distScale,h=[];for(let n=0;n<rt;n++){const[o,e,_]=st(i,i+s);h.push(o,e,_)}return h}function ct(m){let t=[];const s=360/m.count;for(let i=0;i<m.count;i++){const h=s*i,[n,o,e]=[Math.sin(h*(Math.PI/180))*m.radius,0,Math.cos(h*(Math.PI/180))*m.radius];t.push(n,o,e)}return t=et(t,m.height),t}onmessage=({data:m})=>{let t;switch(m.type){case"oortcloud":t=at(m);break;case"particlering":t=ct(m)}t&&postMessage(t)}})();
